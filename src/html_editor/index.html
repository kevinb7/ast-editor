<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="../../lib/ace/src/ace.js"></script>
    <style>
        #editor {
            position: absolute;
            top: 0;
            width: 800px;
            left: 0;
            height: 600px;
        }
        body {
            background-color: gray;
        }
    </style>
</head>
<body>

<div id="editor"></div>

</body>
</html>
<script>

    var editor = ace.edit("editor");
    editor.getSession().setMode("ace/mode/javascript");
    editor.session.setMode("ace/mode/html");
    editor.setOptions({
        fontSize: "14pt"
    });


    var body = {
        tagName: "body",
        attributes: [],
        children: []
    };

    var div = {
        tagName: "div",
        attributes: [{
            name: "id",
            value: "container"
        }, {
            name: "style",
            value: "color:green;"
        }],
        children: [
            "hello, world"
        ]
    };

    body.children.push(div);

    var line = 1;
    var render = function(node, level) {
        level = level || 0;
        var indent = "";
        for (var i = 0; i < level; i++) {
            indent += "    ";
        }
        if (node instanceof Object) {
            console.log("open tag line = " + line);
            var attrs = node.attributes.map(function (attr) {
                return attr.name + '="' + attr.value + '"';
            }).join(" ");
            var open = "<" + node.tagName;
            if (attrs.length > 0) {
                open += " " + attrs;
            }
            open += ">";
            line++;
            var content = node.children.map(function (child) {
                return render(child, level + 1);
            }).join("");
            line++;
            console.log("close tag line = " + line);
            var close = "</" + node.tagName + ">";
            return indent + open + "\n" + content + "\n" + indent + close;
        } else {
            console.log("text line = " + line);
            return indent + node;
        }
    };

    editor.getSession().setValue(render(body));

    editor.on('change', function(e) {

//        console.log(e);

    });

</script>